<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Let's Build a 1D Water Drop Trajectory Simulation</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/https://icinganalysis.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Blast from the Past: NACA Icing Publications RSS Feed" />
<!--
-->
        <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
        <meta name="description" content=""The discrepancies are of the magnitude to be expected from ... the step by step integration". 1 Let's build a 1D water drop trajectory simulation Summary Water..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                        <h1><a href="/">Blast from the Past: NACA Icing Publications</a></h1>
                        <nav><ul>
                            <li><a href="/index.html">Welcome</a></li>
                            <li><a href="/site-navigation-and-suggested-reading-order.html">Suggested Reading Order</a></li>
                            <li><a href="/archives.html">Latest Posts</a></li>
                            <li><a href="/the-basics.html">The Basics</a></li>
                            <li><a href="/about.html">About</a></li>
                        </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/lets-build-a-1d-water-drop-trajectory-simulation.html" rel="bookmark"
           title="Permalink to Let's Build a 1D Water Drop Trajectory Simulation">Let's Build a 1D Water Drop Trajectory Simulation</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-05-25T12:00:00-07:00">
                Published: Wed 25 May 2022
        </abbr>
		<br />
        <abbr class="modified" title="2024-04-26T06:30:42.657539-07:00">
                Updated: Fri 26 April 2024
        </abbr>
<!---->
        <!---->
        <!--<address class="vcard author">-->
                <!--By -->
                        <!--<a class="url fn" href="/author/donald-cook.html">Donald Cook</a>-->
                <!---->
        <!--</address>-->
        <!---->
<!--<p>In <a href="/category/diversions.html">Diversions</a>.</p>-->
<p>tags: <a href="/tag/impingement.html">impingement</a><br> <a href="/tag/evaporation.html">evaporation</a><br> <a href="/tag/python.html">python</a><br> </p>
</footer><!-- /.post-info -->      <p><img alt="Figure 1 of NACA-TN-2903, depicting a cylinder in cross flow with air flow lines and water drop trajectories impacting the cylinder" src="images/cylinder with flow lines.png">  </p>
<h3><em>"The discrepancies are of the magnitude to be expected from ... the step by step integration".</em>  <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></h3>
<h1>Let's build a 1D water drop trajectory simulation</h1>
<h2>Summary</h2>
<p>Water impingement values on a cylinder are calculated with step-by-step integration. </p>
<h2>Key points</h2>
<ol>
<li>1D equations of motion were implemented.  </li>
<li>Results agree well with the minimum drop size required for impingement.  </li>
<li>Water drops may contact the cylinder at very low K values.  </li>
<li>The methods appears accurate enough to use for other applications.  </li>
</ol>
<h2>Discussion</h2>
<p>We are going to start with a one dimensional simulation along a single line,
the stagnation line of flow around a cylinder, y=0 in the figure above. </p>
<p>We will implement the equations of motions for a drop around a cylinder from 
<a href="/mathematical-investigation-of-water-droplet-trajectories.html">"Mathematical Investigation of Water Droplet Trajectories"</a> <sup id="fnref2:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<p>Readers unfamiliar with <a href="/mathematical-investigation-of-water-droplet-trajectories.html">"Mathematical Investigation of Water Droplet Trajectories"</a> 
may wish to review it before proceeding further herein, 
especially to be familiar with the dimensionless terms K and Phi.</p>
<p>We will use the dimensionless coordinate system from Figure 1 above (from <a href="/naca-tn-2903.html">NACA-TN-2903</a>). </p>
<p>We will use python syntax, where exponentiation is "**". </p>
<p>"u" is the dimensionless airspeed. </p>
<p>For incompressible potential flow, 
the airspeed approaching a cylinder is (from <sup id="fnref3:1"><a class="footnote-ref" href="#fn:1">1</a></sup>): </p>
<p><img alt="Equations 23 and 24" src="images/Mathematical Investigation of Water Droplet Trajectories/equations23and24.png">  </p>
<p>For y = 0 (the stagnation line or center-line), this simplifies to: </p>
<div class="highlight"><pre><span></span><code>ux = 1 - 1 / x**2
</code></pre></div>

<p>The coefficient of drag, Cd, for a sphere, where R is Reynolds number, is:</p>
<p><img alt="Equation 22" src="images/Mathematical Investigation of Water Droplet Trajectories/equation22.png">  </p>
<p><img alt="Equation 4" src="images/Mathematical Investigation of Water Droplet Trajectories/equation4.png"><br>
<img alt="Equation 6" src="images/Mathematical Investigation of Water Droplet Trajectories/equation6.png"><br>
<img alt="Equation 12" src="images/Mathematical Investigation of Water Droplet Trajectories/equation12.png">  </p>
<p>Let us go implement the equations, in the file cylinder_drop_1d_trajectory_shift.py <sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>. </p>
<p>I used a time-base, fixed step integrator for the drop position and velocity. 
This will not win any speed contests, but it is simple to implement and understand. </p>
<p>I used d = x + 1 as the position coordinate, 
the reasons will be explained further below. </p>
<p>The time step selected has some effect on the result. 
The dimensionless time step tau = 0.1 had a different result than the other values, 
which are so close together that they cannot be differentiated on this scale. 
I selected tau = 0.001 as the default value. </p>
<p><img alt="Effect of dimensionless time step tau value" src="images/build_a_1d_drop_motion_simulation/1d_cyl_shift_k0.126_tau0.0005_x_vx.png">  </p>
<p>The results are surprising robust to the dimensionless initial location X0 
of the drop for this low K value (small dimensionless drop size). 
The drop was released at the same speed as the nominal airspeed, 
(I did not use the Langmuir and Blodgett estimate of initial drop speed).
The drop velocities rapidly converge to the trajectory for X0 = -20. 
I made X0 = -4 (d=-3) as the default value (the same as Langmuir and Blodgett).</p>
<p><img alt="Effect of dimensionless initial position X0" src="images/build_a_1d_drop_motion_simulation/1d_cyl_shift_k0.126_x_vx.png">  </p>
<p>We want to, among other uses, determine the minimum drop size for impingement. 
In theory, for K = 0.125, the drop decelerates enough so that while it does not stop completely, 
infinite time is required to reach the cylinder surface. 
This will require high accuracy very near x = 1 to differentiate if a drop hits or not. </p>
<p>Equation (23) was recast to use d = x-1, or x = d+1, rather than x. </p>
<div class="highlight"><pre><span></span><code>    ux = 1 - (d+1)**2 / ((d+1)**2)**2
    ux = 1 - 1 / (d+1)**2
    ux = 1 - 1 / (d**2 + 2*d +1)
    ux = ((d**2 + 2*d +1) - 1) / (d**2 + 2*d +1)
    ux = (d**2 + 2*d ) / (d**2 + 2*d +1)

    for small d values, d &lt; 1e-15: 
    ux ~= 2*d / (2*d +1)   drop the d**2 terms
    ux ~= 2*d              approximate the denominator
</code></pre></div>

<p>This may not appear to be much of a change, 
but having a linear term (2*d) rather than a squared term (x**2)
leaves much more "room" in the available floating point precision. 
For example, if d= 4.109382787428e-16 then x is represented in floating point
as rounded off to 1.0000000000000004. 
For smaller values, d can differentiate if a drop hits or not to high precision, 
while x is limited.</p>
<p>I do not have infinite time to wait for a solution, 
so I will compromise and consider that if d &lt; 1e-25, then the drop has impinged on the cylinder. 
This level of precision was required to accurately simulate impingement (or not) 
near K = 0.125. 
The predicted drop final position and velocity agree with the expected results of 
no impingement at K = 0.125, and impingement with K = 0.126.</p>
<p><img alt="Drop final position for values near K=0.125" src="images/build_a_1d_drop_motion_simulation/1d_cyl_shift_near_k_0_125_x_vx.png">  </p>
<p>To compare results at other values of K, we will use Figure 8 from <sup id="fnref4:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.<br>
<img alt="Figure 8. Velocity v_1 at theta = 0, X = 1 for cylinders with 
ideal flow." src="images/Mathematical Investigation of Water Droplet Trajectories/Figure8.png"> </p>
<p>The calculated values are similar, but not identical. 
To use a phrase from <a href="/mathematical-investigation-of-water-droplet-trajectories.html">"Mathematical Investigation of Water Droplet Trajectories"</a>:  </p>
<blockquote>
<p><em>"The discrepancies are of the magnitude to be expected from ... the step by step integration".</em>  </p>
</blockquote>
<p><img alt="Calculated values for Figure 8 conditions" src="images/build_a_1d_drop_motion_simulation/1d_cyl_shift_fig8_vls_4.png">  </p>
<h3>Centroid crossing versus leading edge contact for impingement</h3>
<p>The equations of motion are written for the centroid (center of mass) of the water drop. 
Langmuir and Blodgett did not mention considering the drop diameter for impingement detection,
rather it appears that where the drop mass centroid crosses the cylinder surface is considered impingement. </p>
<blockquote>
<p><img alt="Figure 6 from Langmuir and Blodgett. Trajectories of rime particles 
deposited on cylinder AC drawn by differential analyzer.
" src="images/Mathematical Investigation of Water Droplet Trajectories/LangmuirFigure6.png"><br>
Figure 6 from <sup id="fnref5:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.  </p>
</blockquote>
<p>While the drop diameters are typically small compared to the cylinder diameters, 
the leading edge of the drop is ahead of the mass centroid by the drop radius. 
When we are capable of integrating down to a dimensionless distance of 1e-25 this makes a difference. 
If we define impingement as leading edge contact rather than mass centroid crossing, 
we find that all drop sizes contact, 
down to the lowest K values (dimensionless drop sizes) that the integrator will operate at. 
This is quite different for the theoretic impingement lower K limit of 0.125 for a cylinder. </p>
<p><img alt="Drop contact for low K values." src="images/build_a_1d_drop_motion_simulation/1d_cyl_shift_low_k_x_vx.png"><br>
Note that the terminal distance corresponds to the diameters ratio, d_drop/d_cylinder. </p>
<h2>Conclusions</h2>
<p>We will call this implementation "good enough" for now. </p>
<p>The model is capable of determining water drop relative airspeed, 
which will be important in our next step in the <a href="/water-drop-evaporation.html">Water drop evaporation thread</a>
of calculating mass and heat transfer rates from a drop. </p>
<h2>Notes:</h2>
<p>This is part of the <a href="/water-drop-evaporation.html">Water drop evaporation thread</a>, 
which you may want to review if you came here via a direct link. </p>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>Langmuir, Irving, and Blodgett, Katherine B.: A Mathematical Investigation of Water Droplet Trajectories. Tech. Rep. No. 5418, Air Materiel Command, AAF, Feb. 19, 1946. (Contract No. W-33-038-ac-9151 with General Electric Co.)&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref5:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://github.com/icinganalysis/icinganalysis.github.io">github.com</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
    </div><!-- /.entry-content -->

  </article>
</section>


        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://github.com/icinganalysis/icinganalysis.github.io">github</a></li>
                            <li><a href="https://www.linkedin.com/in/donald-cook-96204316a/">linkedin</a></li>
                            <li><a style="background-image: url('/theme/images/icons/mail.png'); background-size: 16px 16px;"href="mailto:icinganalysis@proton.me">email</a></li>
                            <li><a style="background-image: url('/theme/images/icons/mastodon_square.png'); background-size: 16px 16px;" href="https://historians.social/@icinganalysis">mastodon</a></li>
                            <li><a style="background-image: url('/theme/images/icons/Bluesky_App_Icon.png'); background-size: 16px 16px;" href="https://bsky.app/profile/icinganalysis.bsky.social">bluesky</a></li>
                            <li><a style="background-image: url('/theme/images/icons/rss.png'); background-size: 16px 16px;" href="https://icinganalysis.com/feeds/all.rss.xml">rss</a></li>
                            <li><a style="background-image: url('/theme/images/icons/news.png'); background-size: 16px 16px;" href="https://stats.sender.net/forms/dygqRa/view">Subscribe to the Newsletter</a></li>
                            <li><a style="background-image: url('/theme/images/icons/search_icon.png'); background-size: 16px 16px;" href="https://duckduckgo.com/?t=ffab&q=icinganalysis.com%3A&ia=web">Search (via DDG)</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->




        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Opinions are those of the author, and not any current or former employers.  <br />
                        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"> CC BY-NC-SA 4.0
  <img src='/theme/images/icons/by-nc-sa.png'; width="81";  height="30"; alt="CC-BY-NC-SA 4.0" />
</a> by <a  href=/donald-cook.html>Donald Cook</a>

                </address><!-- /#about -->
                <a rel="me" href="https://mstdn.social/@icinganalysis"> </a>
                <a rel="me" href="https://historians.social/@icinganalysis"></a>

        </footer><!-- /#contentinfo -->
<link rel="shortcut icon" href="/images/favicon.ico?v=2" />
</body>
</html>